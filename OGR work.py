# ---
# jupyter:
#   jupytext:
#     formats: ipynb,py:percent
#     text_representation:
#       extension: .py
#       format_name: percent
#       format_version: '1.3'
#       jupytext_version: 1.13.7
#   kernelspec:
#     display_name: Python [default]
#     language: python
#     name: python2
# ---

# %%
from osgeo import ogr
import os

# %%
workdir = '/Users/pnorton/Projects/National_Hydrology_Model/GIS'
shapefile_name = '{}/GeospatialFabric_National.gdb'.format(workdir)


# %%
# Large hru_order
hru_order = [73208, 73210, 72537, 72538, 72561, 72563, 72571, 72578, 72526, 72552, 72394, 72412, 72392, 72393, 72382, 72391, 72502, 72527, 72480, 72486, 72489, 72490, 72464, 72525, 72499, 72570, 72435, 72443, 72459, 72460, 73177, 72677, 72705, 72603, 72612, 72656, 72663, 72595, 72673, 72609, 72735, 72584, 72585, 72572, 72661, 73100, 73106, 73246, 73248, 72996, 73001, 73026, 73045, 73239, 72998, 73027, 73071, 73091, 72958, 73072, 73240, 72882, 72885, 72881, 72889, 72922, 72929, 72871, 72875, 72898, 72923, 72861, 72865, 72850, 72857, 72855, 72859, 73236, 72847, 72852, 72768, 72789, 73213, 72736, 72743, 72741, 72797, 72733, 72738, 72758, 72760, 72727, 72729, 72772, 72785, 73237, 72854, 72863, 72810, 72812, 72811, 72848, 72826, 72843, 72851, 72837, 72840, 72834, 72844, 72726, 72728, 73231, 73230, 73212, 72764, 72783, 72808, 72830, 72773, 72799, 72740, 72788, 72713, 72714, 72723, 72747, 72718, 72778, 72687, 72746, 72641, 72658, 72597, 72616, 72685, 72647, 72669, 72607, 72631, 72606, 72629, 66726, 66725, 66685, 66690, 66687, 66702, 66686, 66705, 66716, 66727, 66731, 66730, 66647, 66658, 66728, 66724, 66684, 66689, 66670, 66688, 66669, 66672, 66667, 66668, 66820, 66659, 66679, 66648, 66663, 66681, 66695, 66680, 66698, 66645, 66661, 66816, 66819, 66617, 66624, 66600, 66601, 66643, 66579, 66580, 66574, 66587, 66817, 66609, 66618, 66604, 66621, 66563, 66581, 66553, 66572, 66577, 66562, 66569, 66551, 66559, 66537, 66575, 66497, 66541, 66694, 66696, 66729, 66693, 66701, 66664, 66673, 66732, 66818, 66586, 66620, 66523, 66528, 66503, 66526, 66504, 66521, 66554, 66632, 66665, 66555, 66564, 66527, 66502, 66506, 66477, 66550, 66484, 66546, 66525, 66533, 66628, 66634, 66736, 66733, 66734, 66717, 66735, 66636, 66660, 66737, 66625, 66662, 66606, 66627, 66622, 66629, 66611, 66615, 66605, 66610, 66608, 66623, 66480, 66508, 66544, 66538, 66540, 73232, 73228, 72909, 72938, 72888, 72914, 73233, 72829, 72839, 72813, 72853, 72777, 72823, 72867, 72883, 72825, 72862, 72757, 72792, 72662, 72664, 72601, 72630, 72702, 72734, 72602, 72626, 73178, 73167, 73171, 73154, 73168, 73144, 73150, 73120, 73123, 73129, 73130, 73179, 73116, 73117, 73118, 73124, 73126, 73140, 73105, 73107, 73249, 73250, 73115, 73157, 73180, 73083, 73110, 73076, 73092, 73181, 73245, 73043, 73056, 73037, 73040, 73241, 73251, 73029, 73039, 73033, 73078, 72991, 72995, 72978, 73097, 72977, 72982, 73005, 72976, 73003, 72980, 73010, 72972, 72973, 72975, 73007, 72947, 72950, 73234, 73235, 73070, 73102, 73182, 73034, 73044, 73066, 72987, 73017, 72989, 73020, 73014, 73022, 72968, 72985, 73015, 73024, 73012, 73025, 73183, 72969, 73030, 73238, 72890, 72902, 72869, 72899, 73227, 72945, 72946, 72962, 73013, 72912, 72913, 72917, 72907, 72919, 72904, 72920, 72892, 72916, 72895, 72918, 73016, 73038, 66738, 66607, 66640, 66557, 66591, 66536, 66549, 66653, 66656, 66593, 66596, 66455, 66513, 66499, 66511, 66494, 66529, 66742, 66740, 66739, 66746, 66744, 66743, 66713, 66715, 66706, 66710, 66708, 66709, 66704, 66714, 66699, 66703, 66677, 66682, 66747, 66691, 66692, 66674, 66675, 66678, 66671, 66697, 66646, 66652, 66642, 66651, 66822, 66650, 66666, 66633, 66637, 66821, 66745, 66711, 66712, 66614, 66616, 66576, 66588, 66589, 66602, 66548, 66565, 66578, 66516, 66547, 66560, 66514, 66545, 66635, 66649, 66566, 66568, 66509, 66542, 66741, 66603, 66613, 66630, 66631, 66597, 66598, 66590, 66595, 66641, 66655, 66507, 66530, 66796, 66191, 66236, 66195, 66198, 66183, 66201, 66748, 66174, 66181, 66192, 66214, 66186, 66204, 66182, 66188, 66176, 66179, 66177, 66190, 66173, 66213, 66154, 66194, 66149, 66151, 66152, 66157, 66749, 66797, 66794, 66795, 66101, 66111, 66156, 66159, 66163, 66187, 66178, 66224, 66148, 66161, 66106, 66107, 66108, 66114, 66126, 66150, 66115, 66134, 66110, 66116, 66124, 66105, 66128, 66135, 66153, 66104, 66144, 66193, 66218, 66158, 66160, 66130, 66131, 66123, 66146, 66117, 66142, 66086, 66121, 66109, 66112, 66095, 66102, 66091, 66092, 66792, 66750, 66280, 66292, 66270, 66294, 66278, 66282, 66290, 66268, 66271, 66252, 66288, 66237, 66238, 66222, 66254, 66212, 66231, 66751, 66277, 66279, 66804, 66345, 66378, 66807, 66242, 66244, 66250, 66230, 66243, 66249, 66272, 66329, 66343, 66366, 66330, 66381, 66313, 66316, 66303, 66304, 66326, 66246, 66253, 66320, 66247, 66258, 66305, 66337, 66248, 66296, 66310, 66269, 66348, 66300, 66376, 66302, 66324, 66273, 66322, 66798, 66205, 66227, 66084, 66141, 66752, 66069, 66072, 66062, 66077, 66063, 66071, 66064, 66066, 66147, 66208, 66094, 66097, 66165, 66206, 66070, 66074, 66065, 66082, 66180, 66200, 66168, 72573, 72580, 73216, 73215, 73217, 72614, 72688, 72596, 72628, 72623, 72655, 72543, 72553, 72613, 72654, 72711, 72506, 72560, 72577, 72516, 72569, 72413, 72423, 73184, 72575, 72642, 72523, 72549, 72466, 72493, 72465, 72472, 72514, 72469, 72471, 72473, 72531, 72568, 72467, 72468, 72470, 72510, 72512, 72558, 72453, 72484, 72445, 72446, 73159, 73169, 73158, 73170, 73185, 73187, 73160, 73172, 73155, 73164, 73161, 73163, 73174, 73188, 73153, 73173, 73149, 73152, 73145, 73147, 73143, 73162, 73156, 73165, 73132, 73146, 73166, 73131, 73133, 73122, 73125, 73253, 73186, 73142, 73148, 73127, 73128, 73252, 73141, 73151, 66754, 66582, 66599, 66718, 66755, 66570, 66573, 66561, 66585, 66571, 66594, 66520, 66522, 66518, 66539, 66592, 66619, 66815, 66532, 66543, 66753, 66462, 66501, 66756, 66443, 66449, 66402, 66435, 66389, 66392, 66379, 66400, 66534, 66552, 66519, 66524, 66493, 66500, 66461, 66492, 66498, 66814, 66458, 66470, 66437, 66495, 66459, 66463, 66427, 66451, 66457, 66486, 66488, 66531, 66556, 66474, 66475, 66485, 66517, 66464, 66466, 66473, 66453, 66460, 66454, 66496, 66510, 66811, 66422, 66423, 66414, 66418, 66413, 66448, 66398, 66416, 66394, 66401, 66478, 66479, 66428, 66431, 66421, 66426, 66476, 66489, 66490, 66790, 66791, 66140, 66164, 66081, 66090, 66113, 66129, 66067, 66088, 66053, 66079, 66758, 66757, 66801, 66317, 66374, 66312, 66375, 66284, 66314, 66759, 66257, 66306, 66255, 66256, 66221, 66245, 66265, 66297, 66325, 66371, 66321, 66352, 66301, 66318, 66287, 66315, 66251, 66286, 66823, 66760, 66676, 66707, 66683, 66700, 66638, 66639, 66654, 66657, 66558, 66584, 66535, 66567, 66626, 66644, 66583, 66612, 66057, 66061, 66765, 66038, 66044, 66048, 66060, 66764, 66761, 66024, 66029, 66017, 66019, 66047, 66052, 66041, 66042, 66034, 66039, 66040, 66045, 66007, 66008, 66046, 66055, 66021, 66022, 65996, 66000, 66002, 66723, 66763, 65997, 65998, 65979, 65980, 65972, 65987, 65975, 65976, 65968, 65971, 65969, 65974, 65961, 65963, 65966, 66766, 65949, 65950, 65956, 65957, 65954, 65959, 66411, 66430, 66404, 66407, 66403, 66405, 66806, 66468, 66512, 66444, 66447, 66469, 66491, 66445, 66505, 66436, 66438, 66450, 66467, 66441, 66487, 66429, 66432, 66442, 66456, 66419, 66424, 66805, 66481, 66482, 66373, 66380, 66408, 66415, 66410, 66471, 66767, 66319, 66328, 73219, 72749, 72761, 72780, 72815, 73220, 73218, 72703, 72725, 72752, 72769, 72708, 72719, 72650, 72652, 72648, 72649, 72646, 72694, 72770, 72790, 72622, 72731, 72559, 72565, 66364, 66367, 66812, 66813, 66384, 66390, 66391, 66397, 66349, 66361, 66803, 66810, 66425, 66472, 66433, 66452, 66412, 66439, 66386, 66387, 66388, 66420, 66395, 66406, 66382, 66385, 66355, 66377, 66393, 66357, 66370, 66359, 66363, 66358, 66344, 66356, 66360, 66383, 66417, 66347, 66353, 66434, 66446, 66808, 66809, 66483, 66515, 66440, 66465, 72390, 72428, 72387, 72424, 72388, 72402, 73189, 72405, 72418, 72403, 72419, 72395, 72425, 72400, 72431, 72385, 72406, 72386, 72408, 73209, 72540, 72581, 72532, 72548, 72530, 72546, 72477, 72503, 73190, 73207, 72444, 72447, 72441, 72451, 73206, 72562, 72574, 72507, 72524, 72522, 72544, 72482, 72494, 72476, 72478, 72463, 72492, 72452, 72500, 72442, 72454, 72483, 72517, 72961, 73035, 72965, 73019, 72936, 72960, 73225, 73224, 72868, 72887, 72805, 72860, 72791, 72856, 72833, 72838, 72803, 72807, 72744, 72759, 72755, 72756, 72739, 72742, 72870, 72897, 72879, 72925, 72732, 72745, 73018, 73036, 73028, 73055, 72988, 73032, 72964, 73023, 72952, 72953, 72949, 72951, 72901, 72905, 73191, 72458, 72539, 72457, 72461, 72449, 72518, 72448, 72450, 72434, 72436, 72496, 72432, 72433, 72411, 72415, 72383, 72421, 72389, 72399, 72376, 72377, 72397, 72375, 72379, 72370, 72372, 72369, 72371, 73192, 72368, 72380, 72381, 72396, 72366, 72367, 73176, 73193, 73194, 72384, 72401, 72374, 72378, 72409, 72410, 72373, 72398, 72479, 72513, 72533, 72567, 72515, 72534, 72535, 72536, 72519, 72545, 72501, 72520, 72505, 72541, 72529, 72555, 72488, 72504, 72481, 72521, 72554, 72557, 72542, 72547, 72564, 72566, 72427, 72456, 72422, 72426, 72414, 72440, 72404, 72407, 72420, 72462, 72416, 72417, 72487, 72497, 72556, 72485, 72509, 72474, 72475, 72429, 72430, 72498, 72511, 72491, 72495, 72439, 72455, 72437, 72438, 72841, 72842, 72816, 72866, 72794, 72858, 72701, 72751, 72706, 72750, 72931, 72697, 72737, 72763, 72704, 72715, 72690, 72693, 72716, 72691, 72692, 72679, 72682, 72689, 72671, 72681, 72660, 72670, 73211, 72678, 72707, 72710, 72675, 72676, 72674, 72680, 72672, 72724, 72698, 72722, 73247, 73242, 72990, 73009, 73000, 73031, 72967, 73046, 72981, 72994, 72955, 73011, 72944, 72974, 72934, 73002, 72927, 72930, 73229, 72921, 72933, 72915, 72957, 72877, 72926, 73135, 73136, 73195, 73098, 73139, 73088, 73089, 73090, 73093, 73113, 73068, 73096, 73052, 73084, 73094, 73119, 73138, 73053, 73058, 73109, 73137, 73254, 73255, 73082, 73121, 73064, 73074, 73103, 73111, 73063, 73067, 73081, 73099, 73065, 73079, 73051, 73054, 73108, 73048, 73050, 73243, 73244, 73059, 73069, 73060, 73061, 73041, 73042, 73047, 73101, 73008, 73021, 73062, 73073, 72948, 72959, 72924, 72941, 73197, 73080, 73114, 73075, 73104, 73196, 73112, 73134, 73085, 73086, 73095, 73049, 73077, 72942, 72999, 72911, 72986, 72903, 72935, 72963, 72997, 72906, 72971, 72956, 73006, 72970, 72992, 73004, 73087, 73198, 72966, 72979, 72993, 73057, 72910, 72983, 72894, 72939, 72943, 72984, 72820, 72849, 72796, 72891, 72886, 72893, 72809, 72819, 73199, 72771, 72774, 72784, 72818, 72766, 72767, 72836, 72873, 72787, 72828, 72776, 72781, 72821, 72831, 72793, 72832, 72827, 72884, 72795, 72802, 72753, 72874, 72782, 72878, 72611, 72615, 72605, 72617, 72619, 72695, 72579, 72608, 72576, 72591, 72620, 72665, 72684, 72657, 72748, 72668, 72730, 72653, 72699, 73200, 72592, 72625, 72637, 72621, 72640, 72588, 72593, 72594, 72590, 72604, 72624, 72589, 72599, 72586, 72582, 72583, 72587, 72600, 73201, 72550, 72551, 72508, 72528, 73202, 72635, 72639, 72644, 72712, 72634, 72638, 72666, 72633, 72643, 72610, 72632, 72598, 72645, 66721, 66768, 66083, 66120, 66056, 66075, 66788, 66015, 66033, 66051, 66028, 66032, 66014, 66018, 65999, 66013, 65988, 65993, 66011, 66027, 65977, 66003, 65965, 65967, 65986, 65990, 65983, 65984, 65981, 65982, 66722, 66769, 66054, 66076, 66031, 66037, 66012, 66016, 66049, 66050, 66001, 66006, 65992, 65994, 65960, 65973, 65989, 65991, 65962, 65964, 65942, 65948, 66770, 65928, 65932, 65933, 65930, 65936, 66771, 65924, 65929, 65919, 65925, 65916, 65926, 65909, 65922, 65913, 65921, 65898, 65910, 65943, 65958, 65941, 65951, 65934, 65937, 65938, 65935, 65945, 65944, 65947, 65955, 65903, 65918, 65923, 65927, 65901, 65911, 66772, 65900, 65905, 65915, 65917, 65912, 65914, 65946, 65952, 65953, 65939, 65940, 65895, 65899, 65906, 65896, 65897, 66774, 65920, 65931, 66773, 65883, 65884, 65902, 65904, 65907, 65908, 65892, 65893, 65885, 65886, 65890, 65894, 65887, 65889, 65888, 65891, 66776, 66777, 66780, 66778, 66339, 66354, 66340, 66346, 66719, 66779, 66335, 66341, 66334, 66362, 66308, 66311, 66234, 66241, 66276, 66309, 66215, 66239, 66197, 66216, 66169, 66172, 66137, 66166, 66782, 66781, 66783, 66323, 66338, 66263, 66285, 66295, 66291, 66298, 66259, 66281, 66785, 66262, 66264, 66784, 66229, 66240, 66203, 66207, 66225, 66228, 66185, 66199, 66793, 66720, 66786, 66125, 66136, 66132, 66145, 66789, 66119, 66133, 66202, 66260, 66170, 66171, 66162, 66184, 66189, 66138, 66167, 66175, 66118, 66122, 66139, 66089, 66099, 66078, 66103, 66093, 66096, 66080, 66100, 66026, 66030, 66035, 66043, 66196, 66211, 66143, 66155, 66068, 66073, 66058, 66059, 66020, 66023, 65985, 65995, 65970, 65978, 66787, 66396, 66399, 66365, 66372, 66802, 66336, 66342, 66331, 66351, 66799, 66289, 66293, 66266, 66267, 66226, 66275, 66283, 66800, 66299, 66307, 66327, 66368, 66409, 66350, 66369, 66332, 66333, 66223, 66220, 66233, 66261, 66274, 66219, 66232, 66209, 66210, 66217, 66235, 73204, 73175, 73203, 73226, 72908, 72937, 72880, 72954, 72846, 72876, 72845, 72928, 72801, 72822, 73221, 72804, 72835, 72798, 72817, 73222, 72896, 72900, 72932, 72940, 72824, 72872, 72806, 72864, 72800, 72814, 72721, 72775, 72779, 72786, 72720, 72754, 73205, 73214, 73223, 72651, 72686, 72627, 72683, 72696, 72762, 72717, 72765, 72700, 72709, 72618, 72636, 72659, 72667, 66009, 66010, 66762, 66025, 66036, 66004, 66005, 66775, 66085, 66087, 66098, 66127, 43048, 43090, 42023, 42045, 42043, 42110, 42136, 42072, 42086, 42002, 42050, 41942, 42007, 43057, 43091, 41926, 41933, 41931, 41936, 41921, 41963, 41893, 41902, 41949, 41966, 42344, 42369, 42316, 42328, 43034, 43092, 42384, 42390, 42278, 42304, 42319, 43038, 43093, 42373, 42256, 42258, 42277, 42371, 42252, 42260, 43321, 43322, 42249, 42250, 42253, 42246, 42306, 43041, 43094, 42191, 42212, 42194, 42224, 42195, 42223, 42229, 42257, 42205, 42217, 42203, 42230, 42196, 42255, 42174, 42178, 42998, 43097, 42985, 42987, 42975, 42977, 43447, 43448, 42928, 42940, 43441, 43444, 42922, 42934, 43435, 43436, 42913, 42918, 42919, 42926, 42959, 42930, 42932, 42944, 42963, 42943, 42981, 42976, 42982, 42979, 42994, 42942, 42946, 42936, 42941, 42925, 42938, 42920, 42921, 42953, 42962, 42960, 42974, 42955, 42969, 42956, 42986, 42950, 42971, 43000, 43095, 42939, 42958, 42924, 42927, 43442, 43443, 43001, 43096, 43002, 43098, 42929, 42933, 43433, 43434, 42915, 42923, 42910, 42935, 42909, 42911, 42966, 42967, 42350, 42353, 42346, 42363, 43337, 43341, 43338, 43340, 42366, 42382, 43336, 43339, 42360, 42361, 42351, 42357, 42359, 42388, 42339, 42358, 42347, 42356, 42329, 42330, 42394, 42405, 42340, 42342, 43327, 43328, 42321, 42326, 42267, 42337, 42282, 42298, 42192, 42209, 42198, 42200, 42281, 42299, 42273, 42274, 42272, 42302, 42292, 42320, 42325, 42355, 42234, 42261, 42269, 42243, 42270, 42179, 42244, 42125, 42126, 42127, 42140, 42093, 42100, 42098, 42107, 42112, 42115, 42117, 42114, 42122, 42041, 42187, 42042, 42058, 42060, 42038, 42047, 42062, 42070, 43297, 43298, 42015, 42029, 42034, 42035, 42099, 42123, 42080, 42082, 42085, 42036, 42059, 42032, 42033, 41979, 42018, 41960, 41961, 41971, 41978, 41907, 41928, 41937, 41973, 41983, 42006, 42153, 41945, 41947, 41894, 41910, 41911, 41980, 41870, 41872, 41878, 41879, 41854, 41856, 43010, 43141, 42457, 42464, 42468, 42474, 42399, 42400, 42391, 42398, 42422, 42352, 42401, 42385, 42386, 42349, 42354, 42447, 42450, 42345, 42348, 43319, 43320, 42227, 42279, 42295, 42216, 42259, 42221, 42239, 42167, 42172, 42051, 42096, 42148, 42211, 42120, 42128, 42108, 42109, 41955, 41956, 41952, 41954, 41998, 42008, 43329, 43331, 43330, 43332, 43325, 43326, 42285, 42323, 42324, 42291, 42293, 42254, 42275, 42268, 42287, 43323, 43324, 42210, 42214, 42245, 42251, 42220, 42247, 43315, 43316, 42161, 42163, 42169, 42170, 42184, 43313, 43314, 42164, 42204, 42189, 42199, 42240, 42288, 42248, 42263, 43317, 43318, 42336, 42804, 42317, 42318, 42327, 42334, 42201, 42286, 42290, 42207, 42313, 42157, 42162, 42173, 42171, 42235, 42152, 42154, 42177, 42155, 42160, 42188, 42190, 42149, 42165, 42144, 42159, 42118, 42156, 42083, 42134, 43307, 43311, 42046, 42132, 42027, 42097, 43309, 43312, 41995, 42061, 42063, 42022, 42056, 42092, 42168, 43308, 43310, 42052, 42079, 42081, 42084, 42044, 42048, 42019, 42025, 42012, 42017, 42141, 42151, 41993, 41994, 42000, 41972, 42026, 41930, 41932, 41987, 41991, 41938, 41974, 41924, 41925, 41919, 41920, 42176, 42202, 42206, 42075, 42077, 41927, 41929, 43264, 43265, 41852, 41881, 41838, 41848, 41799, 41805, 41775, 41804, 41846, 41849, 41850, 41815, 41817, 43260, 43261, 41819, 41821, 41851, 41855, 41835, 41836, 43281, 43282, 41880, 41882, 41900, 41913, 43060, 43142, 41868, 41873, 41867, 41885, 43262, 43263, 41859, 41871, 41823, 41831, 41865, 41896, 41824, 41857, 41860, 41822, 41862, 43062, 43143, 41806, 41808, 41811, 41825, 41841, 41809, 41813, 43301, 43303, 42074, 42106, 42054, 42071, 42031, 42049, 42001, 42009, 42010, 42011, 42005, 42024, 43302, 43304, 41965, 42021, 41916, 41939, 42040, 42066, 41735, 41807, 41845, 41796, 41798, 41781, 41783, 41760, 41763, 41758, 41759, 41765, 41768, 41738, 41740, 41750, 41751, 41731, 41733, 41725, 41748, 41721, 41732, 41772, 41786, 41711, 41714, 41754, 41774, 41771, 41784, 41773, 41812, 41766, 41769, 41791, 41802, 42158, 42226, 42185, 42193, 43305, 43306, 42103, 42105, 42111, 42116, 42130, 42137, 41914, 41915, 43280, 43283, 41958, 41917, 41934, 41935, 41899, 41923, 41904, 41918, 41886, 41901, 41909, 41869, 41875, 41853, 41941, 41953, 42013, 42014, 42817, 42834, 42797, 42800, 42760, 42806, 42742, 42754, 42727, 42729, 43008, 43144, 42704, 42849, 42671, 42691, 42695, 42668, 42669, 42687, 42675, 42682, 43381, 43387, 42641, 42657, 42647, 42654, 43384, 43388, 42598, 42612, 42583, 42594, 42593, 42599, 42585, 42596, 42597, 42636, 42653, 43385, 43389, 42576, 42578, 42549, 42567, 43351, 43354, 42538, 42581, 42627, 42629, 42717, 42725, 42589, 42604, 42536, 42539, 42534, 42563, 43353, 43355, 42531, 42541, 42517, 42521, 43346, 43349, 42443, 42448, 42423, 42477, 43347, 43348, 42407, 42408, 42402, 42406, 42362, 42367, 42368, 42370, 42493, 42525, 42459, 42462, 42387, 42389, 42338, 42341, 42266, 42297, 42396, 42296, 42309, 42280, 42308, 42264, 42265, 42364, 42392, 42236, 42238, 42469, 42516, 43382, 43391, 42628, 42648, 43379, 43392, 43383, 43393, 42573, 42624, 42630, 43386, 43394, 42587, 42600, 42492, 42509, 43352, 43356, 42558, 42572, 42564, 42569, 42592, 42494, 42530, 42548, 42562, 43380, 43390, 42689, 42694, 42661, 42685, 42686, 42709, 43363, 43368, 42698, 42816, 43367, 43369, 42570, 42603, 42684, 42746, 42784, 42642, 42643, 42658, 42693, 42571, 42575, 43359, 43360, 42638, 42650, 43345, 43350, 42419, 42433, 42441, 42460, 42425, 42430, 42411, 42418, 42513, 42537, 42476, 42497, 42403, 42473, 42379, 42381, 42365, 42372, 42499, 42510, 42997, 43147, 42999, 43148, 42988, 42991, 42992, 42995, 42990, 42993, 42980, 42984, 43445, 43446, 42964, 42973, 42949, 42972, 42948, 42957, 42945, 42970, 42947, 42952, 42996, 43146, 42978, 42989, 42954, 42965, 42961, 42968, 43003, 43149, 42916, 42983, 43438, 43439, 43005, 43150, 42903, 42904, 43004, 43151, 42897, 42907, 42898, 42908, 42885, 42892, 42886, 42889, 43417, 43418, 42881, 42888, 43424, 43427, 42917, 42872, 42880, 42887, 42845, 42850, 42853, 43007, 43152, 42832, 42871, 42874, 42895, 42833, 42836, 42827, 42841, 42854, 42891, 43401, 43406, 43437, 43440, 42791, 42829, 42851, 42790, 42796, 42782, 42778, 42809, 42810, 42798, 42801, 42792, 42820, 42828, 42830, 42844, 42777, 42780, 42785, 42824, 42762, 42763, 42770, 42771, 42793, 42765, 42769, 42772, 42774, 42775, 42786, 42767, 42755, 42761, 42766, 42781, 42756, 42794, 43411, 43412, 42743, 42773, 42823, 42826, 42741, 42764, 42738, 42744, 42747, 42843, 42846, 42735, 42745, 42728, 42733, 42787, 43375, 43377, 42902, 42937, 42951, 43376, 43378, 42724, 42768, 42696, 42697, 43403, 43407, 43404, 43408, 42710, 42731, 42737, 42703, 42705, 42702, 42706, 43364, 43371, 43366, 43370, 42616, 42633, 42574, 42602, 43357, 43358, 43023, 43153, 42522, 42601, 42507, 42532, 42533, 42545, 42542, 42546, 42475, 42479, 42449, 42490, 42432, 42456, 42421, 42439, 43032, 43155, 43333, 43342, 42412, 42413, 43334, 43343, 42424, 42461, 42485, 42486, 42528, 42554, 42465, 42467, 42453, 42503, 42420, 42434, 42435, 42466, 42484, 42416, 42417, 42415, 42445, 43335, 43344, 42395, 42404, 43028, 43154, 43030, 43156, 42438, 42463, 42414, 42427, 42480, 42502, 43423, 43428, 43419, 43421, 43426, 43430, 43425, 43429, 42753, 42758, 42899, 42901, 42906, 42931, 42900, 42914, 42868, 42876, 42890, 42894, 42862, 42863, 42866, 42860, 42878, 42751, 42783, 42852, 42869, 42857, 42859, 42861, 42722, 42779, 42905, 42912, 43431, 43432, 42893, 42896, 43420, 43422, 42882, 42883, 42848, 42858, 42864, 42879, 42839, 42870, 42835, 42838, 42840, 42884, 42752, 42803, 42726, 42831, 42788, 42789, 42805, 42813, 42795, 42799, 42807, 42812, 42819, 42837, 42865, 42821, 42873, 43402, 43409, 43405, 43410, 43365, 43372, 42580, 42651, 42662, 42608, 42670, 42656, 42734, 42750, 42637, 42644, 42645, 42613, 42617, 43361, 43362, 42579, 42595, 42609, 42699, 42566, 42568, 42553, 42584, 42557, 42565, 42660, 42814, 42646, 42655, 42559, 42649, 43006, 43158, 42867, 42875, 43413, 43414, 43397, 43399, 43009, 43157, 42811, 42842, 42748, 42759, 42730, 42815, 43398, 43400, 42720, 42723, 42739, 42740, 42711, 42713, 42700, 42718, 43415, 43416, 42847, 42877, 42712, 42732, 42736, 42802, 42715, 42721, 42808, 42856, 42818, 42822, 42825, 42855, 42631, 42635, 42652, 42663, 42623, 42659, 43395, 43396, 42688, 42708, 42776, 42719, 42749, 42707, 42716, 42683, 42692, 42667, 42680, 42681, 43011, 43159, 42626, 42676, 42714, 42665, 42666, 42674, 42678, 42672, 42673, 42701, 42757, 42664, 42690, 43014, 43160, 43373, 43374, 42621, 42634, 42614, 42618, 42639, 42640, 42611, 42619, 42615, 42620, 42605, 42607, 43017, 43161, 42577, 42610, 43013, 43163, 42560, 42582, 43015, 43164, 42555, 42590, 42550, 42556, 42551, 42552, 43018, 43162, 43022, 43165, 42677, 42679, 42622, 42625, 42213, 42294, 42232, 42262, 41767, 41777, 41782, 41793, 41801, 41843, 41866, 42113, 42119, 42143]

# %%
# use OGR specific exceptions
ogr.UseExceptions()

driver = ogr.GetDriverByName('OpenFileGDB')
gdb = driver.Open(shapefile_name, 0)

# if not ds:
#     print('Unable to open {}'.format(shapefile_name))
# else:
#     layer = ds.GetLayer()
#     featureCount = layer.GetFeatureCount()
#     print 'Number of feature in {}: {}'.format(shapefile_name, featureCount)

# %%
# List layers in file geodatabase

# list to store layers'names
featsClassList = []

# parsing layers by index
for featsClass_idx in range(gdb.GetLayerCount()):
    featsClass = gdb.GetLayerByIndex(featsClass_idx)
    featsClassList.append(featsClass.GetName())
    print('{}: {}'.format(featsClass_idx, featsClass.GetName()))

# sorting
featsClassList.sort()

# printing
# for featsClass in featsClassList:
#     print featsClass

# %%
# Get field names for layer 5
clayer = gdb.GetLayer(6)
clayer_def = clayer.GetLayerDefn()

for ii in range(clayer_def.GetFieldCount()):
    fld_name = clayer_def.GetFieldDefn(ii).GetName()
    print(fld_name)

# %%
hru_str = [str(xx) for xx in hru_order]
hru_arg = ','.join(hru_str)

clayer.SetAttributeFilter("hru_id_nat IN ({})".format(hru_arg))

out_shapefile = 'crap.shp'
out_driver = ogr.GetDriverByName("ESRI Shapefile")

if os.path.exists(out_shapefile):
    out_driver.DeleteDataSource(out_shapefile)

# Create output shapefile
out_ds = out_driver.CreateDataSource(out_shapefile)
out_layer = out_ds.CreateLayer(clayer.GetName(), geom_type=ogr.wkbMultiPolygon)

# Copy field defs from input to output
in_layer_def = clayer.GetLayerDefn()
for ii in range(in_layer_def.GetFieldCount()):
    fld_def = in_layer_def.GetFieldDefn(ii)
    fld_name = fld_def.GetName()
    
#     if fld_name not in field_name_target:
#         continue
    out_layer.CreateField(fld_def)
    
# Get output layer's feature def
out_layer_def = out_layer.GetLayerDefn()

# Add features to the output layer
for in_feat in clayer:
    # Create output feature
    out_feat = ogr.Feature(out_layer_def)
    
    # Add field values from input layer
    for ii in range(out_layer_def.GetFieldCount()):
        fld_def = out_layer_def.GetFieldDefn(ii)
        fld_name = fld_def.GetName()
        
#         if fld_name not in field_name_target:
#             continue
            
        out_feat.SetField(out_layer_def.GetFieldDefn(ii).GetNameRef(), in_feat.GetField(ii))
        
    # Set geometry as centroid??
    geom = in_feat.GetGeometryRef()
    out_feat.SetGeometry(geom.Clone())
    
    # Add new feature to output layer
    out_layer.CreateFeature(out_feat)
    
# Close the datasources
out_ds.Destroy()


# %%
clayer.GetName()

# %%
cnt = ogr.GetDriverCount()
formatsList = []  # Empty List

for i in range(cnt):
    driver = ogr.GetDriver(i)
    driverName = driver.GetName()
    if not driverName in formatsList:
        formatsList.append(driverName)

formatsList.sort() # Sorting the messy list of ogr drivers

for i in formatsList:
    print i

# %%
